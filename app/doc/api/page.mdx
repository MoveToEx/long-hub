import { DataTable } from '@/app/doc/components';
import Accordion from '@mui/material/Accordion';
import AccordionSummary from '@mui/material/AccordionSummary';
import AccordionDetails from '@mui/material/AccordionDetails';
import Typography from '@mui/material/Typography';
import ExpandMoreIcon from '@mui/icons-material/ExpandMore';
import Alert from '@mui/material/Alert';
import Stack from '@mui/material/Stack';


<Typography variant="h2">API</Typography>

## Posts

<Stack sx={{paddingBottom: '6px'}}>

<Accordion>
    <AccordionSummary expandIcon={ <ExpandMoreIcon /> }>
        <code>GET /post/</code> - Get posts
    </AccordionSummary>

    <AccordionDetails>
        Method: `GET`  
        URL: `/post`  
        Params:  

        <DataTable
            head={['Name', 'Description', 'Example', 'Note']}
            data={
                [
                    [<code>offset</code>, 'Skips first %val posts', '0', ''],
                    [<code>limit</code>, 'Max count of posts in response', '24', 'Must not exceed 24' ]
                ]
            } />
        
        Posts are sorted by upload time, from newest to oldest.
    </AccordionDetails>
</Accordion>

<Accordion>
    <AccordionSummary expandIcon={ <ExpandMoreIcon /> }>
        <code>GET /post/search/[selector]</code> - Search for posts that matches a selector
    </AccordionSummary>

    <AccordionDetails>
        Method: `GET`  
        URL: `/post/search/[selector]`, selector=an uri-encoded base64 string of a stringified JSON object, possibly with the following fields:  

        <DataTable
            head={['Name', 'Type', 'Searches for...', 'Example', 'Note']}
            data={
                [
                    [<code>id</code>, <code>string[]</code>, 'Post whose id matches all given patterns', '["4e*", "*f"]', ''],
                    [<code>text</code>, <code>string[]</code>, 'Post whose text contains all of %text', '["你", "妈"]', ''],
                    [<code>tag</code>, <code>object</code>, 'see below for fields', '-', ''],
                    [<code>tag.include</code>, <code>string[]</code>, 'Post that contains all of tags specified', '["monochrome"]', ''],
                    [<code>tag.exclude</code>, <code>string[]</code>, 'Post that does not contain any of tags specified', '["meaningless"]', ''],
                    [<code>aggr</code>, <code>object</code>, 'see below for fields', '-', ''],
                    [<code>aggr.lt</code>, <code>number</code>, 'Post with aggressiveness less than %value', '5.5', ''],
                    [<code>aggr.lte</code>, <code>number</code>, 'Post with aggressiveness less than or equal to %value', '5.5', ''],
                    [<code>aggr.gt</code>, <code>number</code>, 'Post with aggressiveness greater than %value', '5.5', ''],
                    [<code>aggr.gte</code>, <code>number</code>, 'Post with aggressiveness greater than or equal to %value', '5.5', ''],
                    [<code>aggr.eq</code>, <code>number</code>, 'Post with aggressiveness equal to %value', '5.5', ''],
                    [<code>aggr.ne</code>, <code>number</code>, 'Post with aggressiveness not equal to %value', '5.5', '']
                ]   
            } />

        Params:

        <DataTable
            head={['Name', 'Description', 'Example', 'Note']}
            data={
                [
                    [<code>offset</code>, 'Skips first # posts', '0', ''],
                    [<code>limit</code>, 'Max count of posts in response', '24', 'Must not exceed 24' ]
                ]
            } />
    </AccordionDetails>
</Accordion>

<Accordion>
    <AccordionSummary expandIcon={ <ExpandMoreIcon /> }>
        <code>GET /post/tag/[TAG]/</code> - Search for posts tagged with TAG
    </AccordionSummary>

    <AccordionDetails>
        Method: `GET`  
        URL: `/post/tag/[tag]`, tag=Tag name to search for  
        Params: None
    </AccordionDetails>
</Accordion>

<Accordion>
    <AccordionSummary expandIcon={ <ExpandMoreIcon /> }>
        <code>POST /post/</code> - Upload an empty post
    </AccordionSummary>

    <AccordionDetails>
        Method: `POST`  
        URL: `/post/upload`  
        Accepts: `multipart/form-data`  
        Params:

        <DataTable
            head={['Name', 'Description', 'Example', 'Note']}
            data={
                [
                    [<code>image</code>, 'Image', '...', '']
                ]
            } />

        To create a post, combine this endpoint with <code>PUT /post/[id]</code>
    </AccordionDetails>
</Accordion>

<Accordion>
    <AccordionSummary expandIcon={ <ExpandMoreIcon /> }>
        <code>PUT /post/[id]/</code> - Modify a post
    </AccordionSummary>

    <AccordionDetails>
        Method: `PUT`  
        URL: `/post/[id]/`, id=ID of the post to be modified  
        Accepts: <code>application/json</code>  

        Request body:

        <DataTable
            head={['Name', 'Description', 'Example', 'Note']}
            data={
                [
                    [<code>text</code>, 'Text', '"NMSL"', ''],
                    [<code>tags</code>, 'Tags', '["monochrome", "notext"]', 'Must be the type of string[]'],
                    [<code>aggr</code>, 'Aggressiveness', '0.2', 'Must be a number']
                ]
            } />

    </AccordionDetails>
</Accordion>

<Accordion>
    <AccordionSummary expandIcon={ <ExpandMoreIcon /> }>
        <code>POST /similar/</code> - Search for posts with perceptually similar images
    </AccordionSummary>

    <AccordionDetails>
        Method: `POST`  
        URL: `/similar/`  
        Accepts: `multipart/form-data`  
        Params:

        <DataTable
            head={['Name', 'Description', 'Example', 'Note']}
            data={
                [
                    [<code>image</code>, 'Image to search for', '...', '']
                ]
            } />
    </AccordionDetails>
</Accordion>


</Stack>